import React from 'react';
// import NavbarComp from './navComp';
// import MessageComp from './msgComp';
import CarsComp from './carsComp';
import FruitsComp from './fruitsComp';
import CarCreateComp from './carCreateFormComp';

export class HomeComp extends React.Component{

   constructor() {
      super();
      this.state = {
         myCars: [],
         myFruits: [],
         showCars: false,
         showFruits: false,
         carTitle: "Cars",
         fruitTitle: "Fruits",
         showCarForm: false,
         newCarName: "",
         newCarColor: "",
         newCarPrice: ""
      }
      this.receiveCarFormData = this.receiveCarFormData.bind(this)
   }

   componentDidMount() {
      this.callApiGetAllCars().then(res => this.setState({ myCars: res.backCars, showCars: true })).catch(err => console.log(err));
      this.callApiGetAllFruits().then(res => this.setState({ myFruits: res.backFruits, showFruits: true })).catch(err => console.log(err));
   }

   callApiGetAllCars = async () => {
      const response = await fetch('/api/cars');
      const resBody = await response.json();
      if (response.status !== 200) throw Error(resBody.message);
      return resBody;
   };

   callApiGetAllFruits = async () => {
      const response = await fetch('/api/fruits');
      const resBody = await response.json();
      if (response.status !== 200) throw Error(resBody.message);
      return resBody;
   }

   renderCreateCarComp = () => {
      this.setState({
         showCars: false, carTitle: "Create New Car", fruitTitle: "", showFruits: false, showCarForm: true
      })
   }

   receiveCarFormData(name, color, price){
      this.setState({
         showCars: true, carTitle: "Cars", fruitTitle: "Fruits", showFruits: true, showCarForm: false, newCarName: name, newCarColor: color, newCarPrice: price
      })
      console.log("New Data: ", name, color, price);
   }

   render(){
      return (
         <div className='container'>
            <div className='row'>
               {/* <div className='col-md-10 col-md-offset-1'> <NavbarComp /> </div> */}
               {/* <div className='col-md-10 col-md-offset-1'> { this.props.children}</div> */}
            </div>
            {/* <h4> <MessageComp msgText={this.state.myMsg}/> </h4>  */}
            
            <h3> {this.state.carTitle} </h3>
            <button className='btn btn-default' onClick={this.renderCreateCarComp}> Create</button>

            {this.state.showCarForm && <CarCreateComp unRenderComp={this.receiveCarFormData} />}
            {this.state.showCars && <CarsComp theCars={this.state.myCars} />}
            <h3> { this.state.fruitTitle }</h3>
            {this.state.showFruits && <FruitsComp theFruits={this.state.myFruits} />}


            {/* <h4> {this.state.myMsg} </h4> */}
            {
               // this.state.myCars.map((car) => (
               //   <div className='col-md-4 col-sm-4' key={car.id}>
               //     <h4 style={{color:car.color}}>{car.name} </h4>
               //     <p> 
               //       <i className='fa fa-paint-brush'> </i> {car.color} 
               //       <i className='fa fa-dollar-sign'> </i> {car.price} 
               //     </p>
               //   </div>
               // ))
            }

            {
               // this.state.myFruits.map((fruit) => (
               //   <div className='col-md-4 col-sm-4' key={fruit.id}>
               //     <h4 style={{fontSize:fruit.fSize}}>{fruit.name} </h4>
               //     <p> 
               //       <i className='fa fa-scale'> </i> {fruit.weight}
               //     </p>
               //   </div>
               // ))
            }
         </div>
      );
   }
}